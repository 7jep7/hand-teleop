<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hand Teleop MVP - Leader-Follower System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/three@0.160.0/build/three.min.js"></script>
    <script src="https://unpkg.com/three@0.160.0/examples/js/controls/OrbitControls.js"></script>
    <style>
        .analytics-panel {
            transition: all 0.3s ease-in-out;
        }
        .analytics-collapsed {
            transform: translateY(100%);
        }
        .fingertip-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            position: absolute;
            border: 2px solid white;
            box-shadow: 0 0 4px rgba(0,0,0,0.5);
        }
        .thumb-tip { background: #ef4444; }
        .index-pip { background: #22c55e; }
        .index-tip { background: #3b82f6; }
    </style>
</head>
<body class="bg-gray-900 text-white min-h-screen">
    <!-- Main Header -->
    <header class="bg-gray-800 border-b border-gray-700 px-6 py-4">
        <div class="flex items-center justify-between">
            <div>
                <h1 class="text-2xl font-bold text-blue-400">Hand Teleop MVP</h1>
                <p class="text-gray-400 text-sm">Leader-Follower Robot Control System</p>
            </div>
            <div class="flex items-center space-x-4">
                <div class="flex items-center space-x-2">
                    <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                    <span id="status-text" class="text-sm text-gray-300">Ready</span>
                </div>
                <button id="analytics-toggle" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg text-sm transition-colors">
                    üìä Analytics
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="flex h-screen">
        <!-- Left Panel: Controls & Configuration -->
        <div class="w-1/3 bg-gray-800 border-r border-gray-700 p-6 overflow-y-auto">
            <!-- MVP Task Controls -->
            <div class="space-y-6">
                <!-- Task 1: Hand Tracking -->
                <div class="bg-gray-700 rounded-lg p-4">
                    <h3 class="text-lg font-semibold text-green-400 mb-3">üëã Hand Tracking</h3>
                    <div class="space-y-3">
                        <div class="flex items-center space-x-3">
                            <label class="text-sm font-medium w-20">Model:</label>
                            <select id="tracking-model" class="flex-1 bg-gray-600 border border-gray-500 rounded px-3 py-1 text-sm">
                                <option value="mediapipe">MediaPipe</option>
                                <option value="wilor">WiLoR</option>
                            </select>
                        </div>
                        <div class="flex space-x-2">
                            <button id="start-tracking" class="flex-1 bg-green-600 hover:bg-green-700 px-4 py-2 rounded text-sm transition-colors">
                                ‚ñ∂Ô∏è Start Tracking
                            </button>
                            <button id="stop-tracking" class="flex-1 bg-red-600 hover:bg-red-700 px-4 py-2 rounded text-sm transition-colors" disabled>
                                ‚èπÔ∏è Stop
                            </button>
                        </div>
                        <div class="text-xs text-gray-400">
                            <div>Status: <span id="tracking-status">Stopped</span></div>
                            <div>FPS: <span id="tracking-fps">0</span></div>
                        </div>
                    </div>
                </div>

                <!-- Task 2: Robot Configuration -->
                <div class="bg-gray-700 rounded-lg p-4">
                    <h3 class="text-lg font-semibold text-blue-400 mb-3">ü§ñ Robot Setup</h3>
                    <div class="space-y-3">
                        <div class="flex items-center space-x-3">
                            <label class="text-sm font-medium w-20">Robot:</label>
                            <select id="robot-model" class="flex-1 bg-gray-600 border border-gray-500 rounded px-3 py-1 text-sm">
                                <option value="so-101">SO-101 Arm</option>
                                <option value="ur5" disabled>UR5 (Coming Soon)</option>
                                <option value="kuka" disabled>KUKA KR6 (Coming Soon)</option>
                            </select>
                        </div>
                        <div class="flex items-center space-x-3">
                            <label class="text-sm font-medium w-20">Mode:</label>
                            <select id="robot-mode" class="flex-1 bg-gray-600 border border-gray-500 rounded px-3 py-1 text-sm">
                                <option value="simulation">Simulation</option>
                                <option value="real" disabled>Real Robot (Coming Soon)</option>
                            </select>
                        </div>
                        <button id="init-robot" class="w-full bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded text-sm transition-colors">
                            üîß Initialize Robot
                        </button>
                        <div class="text-xs text-gray-400">
                            Status: <span id="robot-status">Not Initialized</span>
                        </div>
                    </div>
                </div>

                <!-- Task 3: Hand-Robot Mapping -->
                <div class="bg-gray-700 rounded-lg p-4">
                    <h3 class="text-lg font-semibold text-purple-400 mb-3">üîó Mapping Control</h3>
                    <div class="space-y-3">
                        <div class="flex items-center space-x-3">
                            <label class="text-sm font-medium w-20">Smoothing:</label>
                            <input id="smoothing-factor" type="range" min="1" max="10" value="5" class="flex-1">
                            <span id="smoothing-value" class="text-xs text-gray-400 w-8">5</span>
                        </div>
                        <div class="flex space-x-2">
                            <button id="start-mapping" class="flex-1 bg-purple-600 hover:bg-purple-700 px-4 py-2 rounded text-sm transition-colors" disabled>
                                üîó Start Mapping
                            </button>
                            <button id="stop-mapping" class="flex-1 bg-gray-600 px-4 py-2 rounded text-sm" disabled>
                                ‚è∏Ô∏è Stop
                            </button>
                        </div>
                        <div class="text-xs text-gray-400">
                            Latency: <span id="mapping-latency">-- ms</span>
                        </div>
                    </div>
                </div>

                <!-- MVP Progress -->
                <div class="bg-gray-700 rounded-lg p-4">
                    <h3 class="text-lg font-semibold text-yellow-400 mb-3">üìã MVP Progress</h3>
                    <div class="space-y-2 text-sm">
                        <div class="flex items-center space-x-2">
                            <div id="task1-status" class="w-3 h-3 bg-green-500 rounded-full"></div>
                            <span>Task 1: Fingertip Detection</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <div id="task2-status" class="w-3 h-3 bg-gray-500 rounded-full"></div>
                            <span>Task 2: Robot Visualization</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <div id="task3-status" class="w-3 h-3 bg-gray-500 rounded-full"></div>
                            <span>Task 3: Hand-Robot Mapping</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <div id="task4-status" class="w-3 h-3 bg-gray-500 rounded-full"></div>
                            <span>Task 4: Integration</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <div id="task5-status" class="w-3 h-3 bg-gray-500 rounded-full"></div>
                            <span>Task 5: UI Controls</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <div id="task6-status" class="w-3 h-3 bg-gray-500 rounded-full"></div>
                            <span>Task 6: Demo Polish</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Panel: Live Demo -->
        <div class="flex-1 relative">
            <!-- Video Feed with Overlays -->
            <div class="relative h-2/3 bg-black">
                <video id="video-feed" autoplay muted class="w-full h-full object-cover"></video>
                <!-- Fingertip Overlays -->
                <div id="fingertip-overlay" class="absolute inset-0 pointer-events-none">
                    <div id="thumb-tip" class="fingertip-dot thumb-tip hidden"></div>
                    <div id="index-pip" class="fingertip-dot index-pip hidden"></div>
                    <div id="index-tip" class="fingertip-dot index-tip hidden"></div>
                </div>
                <!-- Legend -->
                <div class="absolute top-4 left-4 bg-black bg-opacity-50 rounded-lg p-3 text-sm">
                    <h4 class="font-semibold mb-2">Key Points:</h4>
                    <div class="space-y-1">
                        <div class="flex items-center space-x-2">
                            <div class="fingertip-dot thumb-tip"></div>
                            <span>Thumb Tip (#4)</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <div class="fingertip-dot index-pip"></div>
                            <span>Index PIP (#6)</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <div class="fingertip-dot index-tip"></div>
                            <span>Index Tip (#8)</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 3D Robot Visualization -->
            <div class="h-1/3 bg-gray-800 border-t border-gray-700 relative">
                <div id="robot-canvas" class="w-full h-full"></div>
                <div class="absolute top-4 right-4 text-sm text-gray-400">
                    Robot Simulation
                </div>
            </div>
        </div>
    </div>

    <!-- Foldable Analytics Panel -->
    <div id="analytics-panel" class="analytics-panel analytics-collapsed fixed bottom-0 left-0 right-0 bg-gray-800 border-t border-gray-700 h-64 overflow-hidden">
        <div class="p-4 h-full">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-semibold text-blue-400">üìä Live Analytics</h3>
                <button id="analytics-close" class="text-gray-400 hover:text-white">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            
            <div class="grid grid-cols-4 gap-4 h-full">
                <!-- Real-time Coordinates -->
                <div class="bg-gray-700 rounded-lg p-3">
                    <h4 class="text-sm font-medium text-green-400 mb-2">Hand Coordinates</h4>
                    <div class="text-xs space-y-1 font-mono">
                        <div>Thumb: <span id="thumb-coords">---, ---, ---</span></div>
                        <div>Index PIP: <span id="pip-coords">---, ---, ---</span></div>
                        <div>Index Tip: <span id="tip-coords">---, ---, ---</span></div>
                    </div>
                </div>

                <!-- Performance Metrics -->
                <div class="bg-gray-700 rounded-lg p-3">
                    <h4 class="text-sm font-medium text-blue-400 mb-2">Performance</h4>
                    <div class="text-xs space-y-1">
                        <div>Hand Tracking: <span id="hand-fps">0</span> FPS</div>
                        <div>Robot Render: <span id="robot-fps">0</span> FPS</div>
                        <div>Total Latency: <span id="total-latency">-- ms</span></div>
                        <div>Memory: <span id="memory-usage">-- MB</span></div>
                    </div>
                </div>

                <!-- Robot Joint Angles -->
                <div class="bg-gray-700 rounded-lg p-3">
                    <h4 class="text-sm font-medium text-purple-400 mb-2">Robot Joints</h4>
                    <div class="text-xs space-y-1 font-mono">
                        <div>Base: <span id="joint-base">0¬∞</span></div>
                        <div>Shoulder: <span id="joint-shoulder">0¬∞</span></div>
                        <div>Elbow: <span id="joint-elbow">0¬∞</span></div>
                        <div>Wrist: <span id="joint-wrist">0¬∞</span></div>
                    </div>
                </div>

                <!-- System Logs -->
                <div class="bg-gray-700 rounded-lg p-3">
                    <h4 class="text-sm font-medium text-yellow-400 mb-2">System Logs</h4>
                    <div id="system-logs" class="text-xs text-gray-300 h-32 overflow-y-auto space-y-1">
                        <div class="text-green-400">[MVP] System ready</div>
                        <div class="text-blue-400">[Task 1] Fingertip detection implemented</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script src="mvp-ui.js"></script>
</body>
</html>
